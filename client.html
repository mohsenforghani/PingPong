<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Pong Game</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: black;
    height: 100%;
  }
  canvas {
    display: block;
  }
</style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="600"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

// آدرس سرور Render
const ws = new WebSocket('wss://pingpong-te0t.onrender.com'); // این را با URL Render خودت عوض کن

let playerId = null;
let paddleY = 250;
let gameState = { ball:{x:400,y:300,radius:10}, paddles:[{x:50,y:250,w:20,h:100},{x:730,y:250,w:20,h:100}], scores:[0,0] };

ws.onmessage = (msg) => {
    let data = JSON.parse(msg.data);
    if(data.playerId !== undefined) playerId = data.playerId;
    else gameState = data;
}

document.addEventListener('mousemove', e => {
    if(playerId === null) return;
    paddleY = e.clientY - 50;
    ws.send(JSON.stringify({player: playerId, y: paddleY}));
});

document.addEventListener('touchmove', e => {
    if(playerId === null) return;
    let touch = e.touches[0];
    paddleY = touch.clientY - 50;
    ws.send(JSON.stringify({player: playerId, y: paddleY}));
    e.preventDefault();
}, {passive:false});

function drawGame(state){
    ctx.clearRect(0,0,800,600);
    // توپ
    ctx.fillStyle = 'white';
    ctx.beginPath();
    ctx.arc(state.ball.x, state.ball.y, state.ball.radius, 0, Math.PI*2);
    ctx.fill();

    // راکت‌ها
    state.paddles.forEach(p => ctx.fillRect(p.x, p.y, p.w, p.h));

    // امتیاز
    ctx.font = '30px Arial';
    ctx.fillText(state.scores[0], 300, 50);
    ctx.fillText(state.scores[1], 500, 50);
}

function gameLoop(){
    drawGame(gameState);
    requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
</body>
</html>

